GroupingBasics

scheme GroupingEx =
extend GroupingBasics with 
class
  value
    findGroups : Grouping >< Person >< Relation -~-> Group-set
    findGroups(gs, p, r) is {g | g : Group :- g isin gs /\ ~hasFriendsInGroup(p, g, r)},

    hasFriendsInGroup : Person >< Group >< Relation -> Bool
    hasFriendsInGroup(p, g, r) is
      (exists p1 : Person :- p1 isin g /\ areFriends(p1, p, r)),

    tail : Person-set -> Person-set
    tail(ps) is ps \ {hd ps}
end
